{#
/**
 * @file
 * Narrative â€“ full-width image with absolutely positioned content box overlay.
 *
 * Fields: field_box_position (left/right), field_box_theme (dark/red),
 *         field_headline, field_text, field_accordion_items, field_image,
 *         field_credits, field_link, field_anchor_id.
 */
#}
{{ attach_library('hpm/accordion') }}
{% set box_position = paragraph.field_box_position.value|default('left') %}
{% set box_theme = paragraph.field_box_theme.value|default('dark') %}
<section{{ attributes.addClass('narrative', 'relative', 'content-section', 'overflow-hidden', 'max-sm:mb-0') }}>
  {% if paragraph.field_anchor_id.value %}
    <div id="{{ paragraph.field_anchor_id.value }}"></div>
  {% endif %}
  <div class="section-container max-sm:px-0 grid grid-cols-12 gap-x-5
              lg:gap-x-6">

    <div class="relative col-span-12 grid grid-cols-12 gap-x-5
                lg:gap-x-6">
      {# Image #}
      <div class="col-span-12
                  sm:col-span-11 sm:col-start-2
                  md:col-span-10 md:col-start-3
                  lg:col-span-12 lg:col-start-auto">
        {% if content.field_image|render|trim %}
          <div class="relative">
            <div class="image-container js-zoom-image" data-delay=".2">
              {{ content.field_image }}
            </div>
            {% if paragraph.field_credits.value %}
              <div class="credits absolute {{ box_position == 'left' ? 'right-[-2px] bottom-0 rotate-90 origin-bottom-right sm:right-[-4px]' : 'left-[-2px] bottom-0 -rotate-90 origin-bottom-left sm:left-[-4px]' }}">
                <span class="{{ box_position == 'right' ? 'relative block rotate-180 origin-center' }}">
                  {{ paragraph.field_credits.value }}
                </span>
              </div>
            {% endif %}
          </div>
        {% endif %}
      </div>

      {# Content Box #}
      <div class="relative z-[2] col-span-12
                  sm:col-span-10
                  sm:-top-8
                  lg:absolute
                  {% if box_position == 'left' %}
                    lg:-left-8 lg:bottom-8 lg:top-auto lg:w-[41%]
                  {% else %}
                    lg:top-8 lg:-right-8 lg:w-[41%]
                  {% endif %}">
        <div class="text-white
                    {{ box_theme == 'dark' ? 'bg-hpm-darkred' : 'bg-hpm-red' }} js-element-group
                    px-6 py-8
                    sm:px-8 sm:!py-8"
             data-theme="{{ box_theme == 'dark' ? 'darkred' : 'red' }}">

          {% if paragraph.field_headline.value %}
            <h2 class="h3 text-white">
              {{ paragraph.field_headline.value }}
            </h2>
          {% endif %}

          {% if paragraph.field_text.value %}
            <div class="formatted">
              {{ paragraph.field_text.value|raw }}
            </div>
          {% endif %}

          {% if content.field_accordion_items|render|trim %}
            <div class="accordion-block js-accordion mt-6">
              {{ content.field_accordion_items }}
            </div>
          {% endif %}

          {% if button_url %}
            <div class="button-container">
              {% include '@hpm/templates/components/button-link.html.twig' with {
                url: button_url,
                text: button_text,
                variant: 'secondary'
              } only %}
            </div>
          {% endif %}

        </div>
      </div>
    </div>

  </div>
</section>
